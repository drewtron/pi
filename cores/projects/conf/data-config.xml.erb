<?xml version="1.0" encoding="UTF-8" ?>
<dataConfig>
  <dataSource type="JdbcDataSource" driver="com.microsoft.sqlserver.jdbc.SQLServerDriver" url="jdbc:sqlserver://<%=ENV['GLGLIVE']%>:1433;databaseName=GLGLIVE" user="<%=ENV['GLGLIVE_USER']%>" password="<%=ENV['GLGLIVE_PWD']%>"/>

  <document name="Projects">
    <entity name="Projects"
            query="

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

SELECT
  C.CONSULTATION_ID,
  c.TITLE,
  CONSULTATION_DESCRIPTION_TEXT,
  c.CREATED_DATE,
  s.MEETING_STATUS,
  CLIENT.CLIENT_NAME,
  P.FIRST_NAME + ' ' + P.LAST_NAME as CONTACT_NAME,
  RM.FIRST_NAME + ' ' + RM.LAST_NAME as PRIMARY_RM

FROM GLGLIVE.consult.CONSULTATION c
JOIN GLGLIVE.dbo.MEETING_STATUS s on c.CONSULTATION_OVERALL_STATUS_ID = s.MEETING_STATUS_ID
JOIN GLGLIVE.dbo.MEETING_REQUEST_CONTACT_RELATION MRCR
			ON		C.CONSULTATION_ID = MRCR.MEETING_REQUEST_ID
            AND MRCR.PRIMARY_IND = 1
            AND MRCR.ACTIVE_IND = 1
JOIN	GLGLIVE.dbo.CONTACT
			ON		MRCR.CONTACT_ID = CONTACT.CONTACT_ID
JOIN	GLGLIVE.dbo.CLIENT
			ON		CONTACT.CLIENT_ID = CLIENT.CLIENT_ID
JOIN GLGLIVE.dbo.PERSON P ON P.PERSON_ID = CONTACT.PERSON_ID
JOIN GLGLIVE.dbo.PERSON RM on RM.PERSON_ID = c.PRIMARY_RM_PERSON_ID
WHERE c.ACTIVE_IND = 1
			  ">
      <field name="consultationid" column="CONSULTATION_ID" />
      <field name="title" column="TITLE" />
      <field name="description" column="CONSULTATION_DESCRIPTION_TEXT"  />
      <field name="createDate" column="CREATED_DATE" />
      <field name="status" column="MEETING_STATUS" />
      <field name="clientName" column="CLIENT_NAME" />
      <field name="contactName" column="CONTACT_NAME" />
      <field name="primaryRmName" column="PRIMARY_RM" />
    </entity>
  </document>
</dataConfig>
