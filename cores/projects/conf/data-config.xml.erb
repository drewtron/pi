<?xml version="1.0" encoding="UTF-8" ?>
<dataConfig>
  <dataSource type="JdbcDataSource" driver="com.microsoft.sqlserver.jdbc.SQLServerDriver" url="jdbc:sqlserver://<%=ENV['DATABASE_GLGLIVE_SERVER']%>:<%= ENV['DATABASE_GLGLIVE_PORT']%>" user="<%=ENV['DATABASE_GLGLIVE_USER']%>" password="<%=ENV['DATABASE_GLGLIVE_PASSWORD']%>"/>
  <document name="Projects">
    <entity name="Projects"
            query="
            set transaction isolation level read uncommitted;
            SELECT
              c.CONSULTATION_ID as ConsultationId
              ,c.TITLE as Title
              ,CONSULTATION_DESCRIPTION_TEXT as Description
              ,c.CREATED_DATE as CreateDate
              ,COUNCIL_NAME AS PracticeArea
              ,stuff(
               (select ',' + CAST(cm.COUNCIL_MEMBER_ID as varchar(10)) from GLGLIVE.consult.CONSULTATION_PARTICIPANT cp INNER JOIN GLGLIVE.dbo.COUNCIL_MEMBER cm on cm.PERSON_ID = cp.PERSON_ID where c.CONSULTATION_ID = cp.CONSULTATION_ID and cp.ACTIVE_IND = 1 for xml path('')),1,1,'')
              as CouncilMemberIds
            FROM
              GLGLIVE.consult.CONSULTATION c
              INNER JOIN GLGLIVE.dbo.MEETING_REQUEST_COUNCIL_RELATION mr ON mr.MEETING_REQUEST_ID = c.CONSULTATION_ID
              INNER JOIN GLGLIVE.dbo.COUNCIL co ON mr.COUNCIL_ID = co.COUNCIL_ID
            WHERE
              c.ACTIVE_IND = 1
			  ">
      <field name="id" column="ConsultationId" />
      <field name="councilmemberids" column="CouncilMemberIds" />
      <field name="title" column="Title" />
      <field name="description" column="Description"  />
      <field name="consultationId" column="ConsultationId" />
      <field name="practiceArea" column="PracticeArea" />
      <field name="createDate" column="CreateDate" />
    </entity>
  </document>
</dataConfig>
